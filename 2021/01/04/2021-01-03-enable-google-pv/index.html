<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="This post is to enable Page Views on the Chirpy theme based blog that you just built. This requires technical knowledge and it’s recommended to keep the google_analytics.pv.* empty unless you have a g">
<meta property="og:type" content="article">
<meta property="og:title" content="Enable Google Page Views">
<meta property="og:url" content="http://example.com/2021/01/04/2021-01-03-enable-google-pv/index.html">
<meta property="og:site_name" content="科研点滴">
<meta property="og:description" content="This post is to enable Page Views on the Chirpy theme based blog that you just built. This requires technical knowledge and it’s recommended to keep the google_analytics.pv.* empty unless you have a g">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/posts/20210103/01-google-analytics-data-stream.png">
<meta property="og:image" content="http://example.com/posts/20210103/02-google-analytics-realtime.png">
<meta property="og:image" content="http://example.com/posts/20210103/03-superProxy-deployed.png">
<meta property="og:image" content="http://example.com/posts/20210103/04-superproxy-query.png">
<meta property="og:image" content="http://example.com/posts/20210103/05-superproxy-dashboard.png">
<meta property="article:published_time" content="2021-01-03T23:32:00.000Z">
<meta property="article:modified_time" content="2021-10-08T04:43:55.310Z">
<meta property="article:author" content="李季">
<meta property="article:tag" content="google analytics">
<meta property="article:tag" content="pageviews">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/posts/20210103/01-google-analytics-data-stream.png">

<link rel="canonical" href="http://example.com/2021/01/04/2021-01-03-enable-google-pv/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Enable Google Page Views | 科研点滴</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">科研点滴</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/04/2021-01-03-enable-google-pv/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="李季">
      <meta itemprop="description" content="hello world">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="科研点滴">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Enable Google Page Views
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-01-04 07:32:00" itemprop="dateCreated datePublished" datetime="2021-01-04T07:32:00+08:00">2021-01-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-10-08 12:43:55" itemprop="dateModified" datetime="2021-10-08T12:43:55+08:00">2021-10-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blogging/" itemprop="url" rel="index"><span itemprop="name">Blogging</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blogging/Tutorial/" itemprop="url" rel="index"><span itemprop="name">Tutorial</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>This post is to enable Page Views on the <a target="_blank" rel="noopener" href="https://github.com/cotes2020/jekyll-theme-chirpy/"><strong>Chirpy</strong></a> theme based blog that you just built. This requires technical knowledge and it’s recommended to keep the <code>google_analytics.pv.*</code> empty unless you have a good reason. If your website has low traffic, the page views count would discourage you to write more blogs. With that said, let’s start with the setup.</p>
<span id="more"></span>

<h2 id="Set-up-Google-Analytics"><a href="#Set-up-Google-Analytics" class="headerlink" title="Set up Google Analytics"></a>Set up Google Analytics</h2><h3 id="Create-GA-account-and-property"><a href="#Create-GA-account-and-property" class="headerlink" title="Create GA account and property"></a>Create GA account and property</h3><p>First, you need to set up your account on Google analytics. While you create your account, you must create your first <strong>Property</strong> as well.</p>
<ol>
<li>Head to <a target="_blank" rel="noopener" href="https://analytics.google.com/">https://analytics.google.com/</a> and click on <strong>Start Measuring</strong></li>
<li>Enter your desired <em>Account Name</em> and choose the desired checkboxes</li>
<li>Enter your desired <em>Property Name</em>. This is the name of the tracker project that appears on your Google Analytics dashboard</li>
<li>Enter the required information <em>About your business</em></li>
<li>Hit <em>Create</em> and accept any license popup to set up your Google Analytics account and create your property</li>
</ol>
<h3 id="Create-Data-Stream"><a href="#Create-Data-Stream" class="headerlink" title="Create Data Stream"></a>Create Data Stream</h3><p>With your property created, you now need to set up Data Stream to track your blog traffic. After you signup, the prompt should automatically take you to create your first <strong>Data Stream</strong>. If not, follow these steps:</p>
<ol>
<li>Go to <strong>Admin</strong> on the left column</li>
<li>Select the desired property from the drop-down on the second column</li>
<li>Click on <strong>Data Streams</strong></li>
<li>Add a stream and click on <strong>Web</strong></li>
<li>Enter your blog’s URL</li>
</ol>
<p>It should look like this:</p>
<p><img src="/posts/20210103/01-google-analytics-data-stream.png" alt="google-analytics-data-stream">{: width=”1086” height=”542”}</p>
<p>Now, click on the new data stream and grab the <strong>Measurement ID</strong>. It should look something like <code>G-V6XXXXXXXX</code>. Copy this to your <code>_config.yml</code> file</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">google_analytics:</span></span><br><span class="line">  <span class="attr">id:</span> <span class="string">&#x27;G-V6XXXXXXX&#x27;</span>   <span class="comment"># fill in your Google Analytics ID</span></span><br><span class="line">  <span class="comment"># Google Analytics pageviews report settings</span></span><br><span class="line">  <span class="attr">pv:</span></span><br><span class="line">    <span class="attr">proxy_endpoint:</span>   <span class="comment"># fill in the Google Analytics superProxy endpoint of Google App Engine</span></span><br><span class="line">    <span class="attr">cache_path:</span>       <span class="comment"># the local PV cache data, friendly to visitors from GFW region</span></span><br></pre></td></tr></table></figure>
<p>{: file=”_config.yml”}</p>
<p>When you push these changes to your blog, you should start seeing the traffic on your Google Analytics. Play around with the Google Analytics dashboard to get familiar with the options available as it takes like 5 mins to pick up your changes. You should now be able to monitor your traffic in real time.</p>
<p><img src="/posts/20210103/02-google-analytics-realtime.png" alt="google-analytics-realtime">{: width=”616” height=”557”}</p>
<h2 id="Setup-Page-Views"><a href="#Setup-Page-Views" class="headerlink" title="Setup Page Views"></a>Setup Page Views</h2><p>There is a detailed <a target="_blank" rel="noopener" href="https://developers.google.com/analytics/solutions/google-analytics-super-proxy">tutorial</a> available to set up Google Analytics superProxy. But, if you are interested to just quickly get your Chirpy-based blog display page views, follow along. These steps were tested on a Linux machine. If you are running Windows, you can use the Git bash terminal to run Unix-like commands.</p>
<h3 id="Setup-Google-App-Engine"><a href="#Setup-Google-App-Engine" class="headerlink" title="Setup Google App Engine"></a>Setup Google App Engine</h3><ol>
<li><p>Visit <a target="_blank" rel="noopener" href="https://console.cloud.google.com/appengine">https://console.cloud.google.com/appengine</a></p>
</li>
<li><p>Click on <strong>Create Application</strong></p>
</li>
<li><p>Click on <strong>Create Project</strong></p>
</li>
<li><p>Enter the name and choose the data center close to you</p>
</li>
<li><p>Select <strong>Python</strong> language and <strong>Standard</strong> environment</p>
</li>
<li><p>Enable billing account. Yeah, you have to link your credit card. But, you won’t be billed unless you exceed your free quota. For a simple blog, the free quota is more than sufficient.</p>
</li>
<li><p>Go to your App Engine dashboard on your browser and select <strong>API &amp; Services</strong> from the left navigation menu</p>
</li>
<li><p>Click on <strong>Enable APIs and Services</strong> button on the top</p>
</li>
<li><p>Enable the following APIs: <em>Google Analytics API</em></p>
</li>
<li><p>On the left, Click on <em>OAuth Consent Screen</em> and accept <strong>Configure Consent Screen</strong>. Select <strong>External</strong> since your blog is probably hosted for the public. Click on <strong>Publish</strong> under <em>Publishing Status</em></p>
</li>
<li><p>Click on <strong>Credentials</strong> on the left and create a new <strong>OAuth Client IDs</strong> credential. Make sure to add an entry under <code>Authorized redirect URIs</code> that matches: <code>https://&lt;project-id&gt;.&lt;region&gt;.r.appspot.com/admin/auth</code></p>
</li>
<li><p>Note down the <strong>Your Client ID</strong> and <strong>Your Client Secret</strong>. You’ll need this in the next section.</p>
</li>
<li><p>Download and install the cloud SDK for your platform: <a target="_blank" rel="noopener" href="https://cloud.google.com/sdk/docs/quickstart">https://cloud.google.com/sdk/docs/quickstart</a></p>
</li>
<li><p>Run the following commands:</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@bc96abf71ef8 /]# gcloud init</span><br><span class="line"></span><br><span class="line">~snip~</span><br><span class="line"></span><br><span class="line">Go to the following link in your browser:</span><br><span class="line"></span><br><span class="line">    https://accounts.google.com/o/oauth2/auth?response_type=code&amp;client_id=XYZ.apps.googleusercontent.com&amp;redirect_uri=ABCDEFG</span><br><span class="line"></span><br><span class="line">Enter verification code: &lt;VERIFICATION CODE THAT YOU GET AFTER YOU VISIT AND AUTHENTICATE FROM THE ABOVE LINK&gt;</span><br><span class="line"></span><br><span class="line">You are logged in as: [blah_blah@gmail.com].</span><br><span class="line"></span><br><span class="line">Pick cloud project to use:</span><br><span class="line">[1] chirpy-test-300716</span><br><span class="line">[2] Create a new project</span><br><span class="line">Please enter numeric choice or text value (must exactly match list</span><br><span class="line">item): 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@bc96abf71ef8 /]# gcloud info</span><br><span class="line"><span class="meta">#</span><span class="bash"> Your selected project info should be displayed here</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="Setup-Google-Analytics-superProxy"><a href="#Setup-Google-Analytics-superProxy" class="headerlink" title="Setup Google Analytics superProxy"></a>Setup Google Analytics superProxy</h3><ol>
<li><p>Clone the <strong>Google Analytics superProxy</strong> project on Github: <a target="_blank" rel="noopener" href="https://github.com/googleanalytics/google-analytics-super-proxy">https://github.com/googleanalytics/google-analytics-super-proxy</a> to your local.</p>
</li>
<li><p>Remove the first 2 lines in the <a target="_blank" rel="noopener" href="https://github.com/googleanalytics/google-analytics-super-proxy/blob/master/src/app.yaml#L1-L2"><code>src/app.yaml</code></a> file:</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- application: your-project-id</span></span><br><span class="line"><span class="deletion">- version: 1</span></span><br></pre></td></tr></table></figure></li>
<li><p>In <code>src/config.py</code>, add the <code>OAUTH_CLIENT_ID</code> and <code>OAUTH_CLIENT_SECRET</code> that you gathered from your App Engine Dashboard.</p>
</li>
<li><p>Enter any random key for <code>XSRF_KEY</code>, your <code>config.py</code> should look similar to this</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python2.7</span></span><br><span class="line"></span><br><span class="line">__author__ = <span class="string">&#x27;pete.frisella@gmail.com (Pete Frisella)&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># OAuth 2.0 Client Settings</span></span><br><span class="line">AUTH_CONFIG = &#123;</span><br><span class="line">  <span class="string">&#x27;OAUTH_CLIENT_ID&#x27;</span>: <span class="string">&#x27;YOUR_CLIENT_ID&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;OAUTH_CLIENT_SECRET&#x27;</span>: <span class="string">&#x27;YOUR_CLIENT_SECRET&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;OAUTH_REDIRECT_URI&#x27;</span>: <span class="string">&#x27;%s%s&#x27;</span> % (</span><br><span class="line">    <span class="string">&#x27;https://chirpy-test-XXXXXX.ue.r.appspot.com&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;/admin/auth&#x27;</span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># XSRF Settings</span></span><br><span class="line">XSRF_KEY = <span class="string">&#x27;OnceUponATimeThereLivedALegend&#x27;</span></span><br></pre></td></tr></table></figure>
<p> {: file=”src/config.py”}</p>
<p> <strong>Tip:</strong> You can configure a custom domain instead of <code>https://PROJECT_ID.REGION_ID.r.appspot.com</code>. But, for the sake of keeping it simple, we will be using the Google provided default URL.</p>
</li>
<li><p>From inside the src/ directory, deploy the app</p>
 <figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@bc96abf71ef8 src]# gcloud app deploy</span><br><span class="line">Services to deploy:</span><br><span class="line"></span><br><span class="line">descriptor:      [/tmp/google-analytics-super-proxy/src/app.yaml]</span><br><span class="line">source:          [/tmp/google-analytics-super-proxy/src]</span><br><span class="line">target project:  [chirpy-test-XXXX]</span><br><span class="line">target service:  [default]</span><br><span class="line">target version:  [VESRION_NUM]</span><br><span class="line">target url:      [https://chirpy-test-XXXX.ue.r.appspot.com]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Do you want to continue (Y/n)? Y</span><br><span class="line"></span><br><span class="line">Beginning deployment of service [default]...</span><br><span class="line">╔════════════════════════════════════════════════════════════╗</span><br><span class="line">╠═ Uploading 1 file to Google Cloud Storage                 ═╣</span><br><span class="line">╚════════════════════════════════════════════════════════════╝</span><br><span class="line">File upload done.</span><br><span class="line">Updating service [default]...done.</span><br><span class="line">Setting traffic split for service [default]...done.</span><br><span class="line">Deployed service [default] to [https://chirpy-test-XXXX.ue.r.appspot.com]</span><br><span class="line"></span><br><span class="line">You can stream logs from the command line by running:</span><br><span class="line"><span class="meta">$</span><span class="bash"> gcloud app logs tail -s default</span></span><br><span class="line"></span><br><span class="line">To view your application in the web browser run:</span><br><span class="line"><span class="meta">$</span><span class="bash"> gcloud app browse</span></span><br></pre></td></tr></table></figure></li>
<li><p>Visit the deployed service. Add a <code>/admin</code> to the end of the URL.</p>
</li>
<li><p>Click on <strong>Authorize Users</strong> and make sure to add yourself as a managed user.</p>
</li>
<li><p>If you get any errors, please Google it. The errors are self-explanatory and should be easy to fix.</p>
</li>
</ol>
<p>If everything went good, you’ll get this screen:</p>
<p><img src="/posts/20210103/03-superProxy-deployed.png" alt="superProxy-deployed">{: width=”1366” height=”354”}</p>
<h3 id="Create-Google-Analytics-Query"><a href="#Create-Google-Analytics-Query" class="headerlink" title="Create Google Analytics Query"></a>Create Google Analytics Query</h3><p>Head to <code>https://PROJECT_ID.REGION_ID.r.appspot.com/admin</code> and create a query after verifying the account. <strong>GA Core Reporting API</strong> query request can be created in <a target="_blank" rel="noopener" href="https://ga-dev-tools.appspot.com/query-explorer/">Query Explorer</a>.</p>
<p>The query parameters are as follows:</p>
<ul>
<li><strong>start-date</strong>: fill in the first day of blog posting</li>
<li><strong>end-date</strong>: fill in <code>today</code> (this is a parameter supported by GA Report, which means that it will always end according to the current query date)</li>
<li><strong>metrics</strong>: select <code>ga:pageviews</code></li>
<li><strong>dimensions</strong>: select <code>ga:pagePath</code></li>
</ul>
<p>In order to reduce the returned results and reduce the network bandwidth, we add custom filtering rules [^ga-filters]:</p>
<ul>
<li><p><strong>filters</strong>: fill in <code>ga:pagePath=~^/posts/.*/$;ga:pagePath!@=</code>.</p>
<p>  Among them, <code>;</code> means using <em>logical AND</em> to concatenate two rules.</p>
<p>  If the <code>site.baseurl</code> is specified, change the first filtering rule to <code>ga:pagePath=~^/BASE_URL/posts/.*/$</code>, where <code>BASE_URL</code> is the value of <code>site.baseurl</code>.</p>
</li>
</ul>
<p>After <kbd>Run Query</kbd>, copy the generated contents of <strong>API Query URI</strong> at the bottom of the page and fill in the <strong>Encoded URI for the query</strong> of SuperProxy on GAE.</p>
<p>After the query is saved on GAE, a <strong>Public Endpoint</strong> (public access address) will be generated, and we will get the query result in JSON format when accessing it. Finally, click <kbd>Enable Endpoint</kbd> in <strong>Public Request Endpoint</strong> to make the query effective, and click <kbd>Start Scheduling</kbd> in <strong>Scheduling</strong> to start the scheduled task.</p>
<p><img src="/posts/20210103/04-superproxy-query.png" alt="superproxy-query">{: width=”1100” height=”126”}</p>
<h2 id="Configure-Chirpy-to-Display-Page-View"><a href="#Configure-Chirpy-to-Display-Page-View" class="headerlink" title="Configure Chirpy to Display Page View"></a>Configure Chirpy to Display Page View</h2><p>Once all the hard part is done, it is very easy to enable the Page View on Chirpy theme. Your superProxy dashboard should look something like below and you can grab the required values.</p>
<p><img src="/posts/20210103/05-superproxy-dashboard.png" alt="superproxy-dashboard">{: width=”1210” height=”694”}</p>
<p>Update the <code>_config.yml</code> file of <a target="_blank" rel="noopener" href="https://github.com/cotes2020/jekyll-theme-chirpy/"><strong>Chirpy</strong></a> project with the values from your dashboard, to look similar to the following:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">google_analytics:</span></span><br><span class="line">  <span class="attr">id:</span> <span class="string">&#x27;G-V6XXXXXXX&#x27;</span>   <span class="comment"># fill in your Google Analytics ID</span></span><br><span class="line">  <span class="attr">pv:</span></span><br><span class="line">    <span class="attr">proxy_endpoint:</span> <span class="string">&#x27;https://PROJECT_ID.REGION_ID.r.appspot.com/query?id=&lt;ID FROM SUPER PROXY&gt;&#x27;</span></span><br><span class="line">    <span class="attr">cache_path:</span>       <span class="comment"># the local PV cache data, friendly to visitors from GFW region</span></span><br></pre></td></tr></table></figure>
<p>{: file=”_config.yml”}</p>
<p>Now, you should see the Page View enabled on your blog.</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>[^ga-filters]: <a target="_blank" rel="noopener" href="https://developers.google.com/analytics/devguides/reporting/core/v3/reference#filters">Google Analytics Core Reporting API: Filters</a></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/google-analytics/" rel="tag"># google analytics</a>
              <a href="/tags/pageviews/" rel="tag"># pageviews</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/08/11/2019-08-11-customize-the-favicon/" rel="prev" title="Customize the Favicon">
      <i class="fa fa-chevron-left"></i> Customize the Favicon
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Set-up-Google-Analytics"><span class="nav-number">1.</span> <span class="nav-text">Set up Google Analytics</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Create-GA-account-and-property"><span class="nav-number">1.1.</span> <span class="nav-text">Create GA account and property</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Create-Data-Stream"><span class="nav-number">1.2.</span> <span class="nav-text">Create Data Stream</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Setup-Page-Views"><span class="nav-number">2.</span> <span class="nav-text">Setup Page Views</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Setup-Google-App-Engine"><span class="nav-number">2.1.</span> <span class="nav-text">Setup Google App Engine</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Setup-Google-Analytics-superProxy"><span class="nav-number">2.2.</span> <span class="nav-text">Setup Google Analytics superProxy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Create-Google-Analytics-Query"><span class="nav-number">2.3.</span> <span class="nav-text">Create Google Analytics Query</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Configure-Chirpy-to-Display-Page-View"><span class="nav-number">3.</span> <span class="nav-text">Configure Chirpy to Display Page View</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reference"><span class="nav-number">4.</span> <span class="nav-text">Reference</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="李季"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">李季</p>
  <div class="site-description" itemprop="description">hello world</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">5</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

      
  <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
  <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div id="myCanvasContainer" class="widget tagcloud">
      <canvas width="250" height="250" id="resCanvas" style="width:100%">
        <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/favicon/" rel="tag">favicon</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/getting-started/" rel="tag">getting started</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/google-analytics/" rel="tag">google analytics</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pageviews/" rel="tag">pageviews</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/typography/" rel="tag">typography</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/writing/" rel="tag">writing</a><span class="tag-list-count">1</span></li></ul>
      </canvas>
    </div>
  </div>

        
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">李季</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
